<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Adding Resources | Intro to R-Spatial for Healthy Places</title>
  <meta name="description" content="This was developed for a workshop at the 2021 R-Medicine Conference by the Health Regions &amp; Policies Lab at the University of Chicago ." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Adding Resources | Intro to R-Spatial for Healthy Places" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This was developed for a workshop at the 2021 R-Medicine Conference by the Health Regions &amp; Policies Lab at the University of Chicago ." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Adding Resources | Intro to R-Spatial for Healthy Places" />
  
  <meta name="twitter:description" content="This was developed for a workshop at the 2021 R-Medicine Conference by the Health Regions &amp; Policies Lab at the University of Chicago ." />
  



<meta name="date" content="2021-08-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="02-choropleth.html"/>
<link rel="next" href="04-newsvar.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Background</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#environment-setup"><i class="fa fa-check"></i>Environment Setup</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="01-intro.html"><a href="01-intro.html"><i class="fa fa-check"></i><b>1</b> Intro to Spatial Data</a><ul>
<li class="chapter" data-level="1.1" data-path="01-intro.html"><a href="01-intro.html#load-spatial-data"><i class="fa fa-check"></i><b>1.1</b> Load Spatial Data</a></li>
<li class="chapter" data-level="1.2" data-path="01-intro.html"><a href="01-intro.html#non-spatial-spatial-views"><i class="fa fa-check"></i><b>1.2</b> Non-Spatial &amp; Spatial Views</a></li>
<li class="chapter" data-level="1.3" data-path="01-intro.html"><a href="01-intro.html#spatial-data-structure"><i class="fa fa-check"></i><b>1.3</b> Spatial Data Structure</a></li>
<li class="chapter" data-level="1.4" data-path="01-intro.html"><a href="01-intro.html#exploring-coordinate-reference-systems"><i class="fa fa-check"></i><b>1.4</b> Exploring Coordinate Reference Systems</a></li>
<li class="chapter" data-level="1.5" data-path="01-intro.html"><a href="01-intro.html#refine-basic-map"><i class="fa fa-check"></i><b>1.5</b> Refine Basic Map</a></li>
<li class="chapter" data-level="1.6" data-path="01-intro.html"><a href="01-intro.html#arrange-multiple-maps"><i class="fa fa-check"></i><b>1.6</b> Arrange multiple maps</a></li>
<li class="chapter" data-level="1.7" data-path="01-intro.html"><a href="01-intro.html#interactive-mode"><i class="fa fa-check"></i><b>1.7</b> Interactive Mode</a></li>
<li class="chapter" data-level="1.8" data-path="01-intro.html"><a href="01-intro.html#overlay-zip-code-boundaries"><i class="fa fa-check"></i><b>1.8</b> Overlay Zip Code Boundaries</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html#more-resources"><i class="fa fa-check"></i>More Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-choropleth.html"><a href="02-choropleth.html"><i class="fa fa-check"></i><b>2</b> Map Neighborhoods</a><ul>
<li class="chapter" data-level="2.1" data-path="02-choropleth.html"><a href="02-choropleth.html#clean-attribute-data"><i class="fa fa-check"></i><b>2.1</b> Clean Attribute Data</a></li>
<li class="chapter" data-level="2.2" data-path="02-choropleth.html"><a href="02-choropleth.html#merge-spatial-data"><i class="fa fa-check"></i><b>2.2</b> Merge Spatial Data</a></li>
<li class="chapter" data-level="2.3" data-path="02-choropleth.html"><a href="02-choropleth.html#quantile-maps"><i class="fa fa-check"></i><b>2.3</b> Quantile Maps</a></li>
<li class="chapter" data-level="2.4" data-path="02-choropleth.html"><a href="02-choropleth.html#standard-deviation-maps"><i class="fa fa-check"></i><b>2.4</b> Standard Deviation Maps</a></li>
<li class="chapter" data-level="2.5" data-path="02-choropleth.html"><a href="02-choropleth.html#jenks-maps"><i class="fa fa-check"></i><b>2.5</b> Jenks Maps</a></li>
<li class="chapter" data-level="2.6" data-path="02-choropleth.html"><a href="02-choropleth.html#integrate-more-data"><i class="fa fa-check"></i><b>2.6</b> Integrate More Data</a></li>
<li class="chapter" data-level="2.7" data-path="02-choropleth.html"><a href="02-choropleth.html#thematic-map-panel"><i class="fa fa-check"></i><b>2.7</b> Thematic Map Panel</a></li>
<li class="chapter" data-level="2.8" data-path="02-choropleth.html"><a href="02-choropleth.html#write-data"><i class="fa fa-check"></i><b>2.8</b> Write Data</a></li>
<li class="chapter" data-level="" data-path="02-choropleth.html"><a href="02-choropleth.html#more-resources-1"><i class="fa fa-check"></i>More Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html"><i class="fa fa-check"></i><b>3</b> Adding Resources</a><ul>
<li class="chapter" data-level="3.1" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#geocode"><i class="fa fa-check"></i><b>3.1</b> Geocode</a></li>
<li class="chapter" data-level="3.2" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#convert-to-spatial-data"><i class="fa fa-check"></i><b>3.2</b> Convert to Spatial Data</a></li>
<li class="chapter" data-level="3.3" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#basic-map-of-points"><i class="fa fa-check"></i><b>3.3</b> Basic Map of Points</a></li>
<li class="chapter" data-level="3.4" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#overlay-points-style"><i class="fa fa-check"></i><b>3.4</b> Overlay Points &amp; Style</a></li>
<li class="chapter" data-level="3.5" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#integrate-more-data-1"><i class="fa fa-check"></i><b>3.5</b> Integrate More Data</a></li>
<li class="chapter" data-level="3.6" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#graduated-symbology"><i class="fa fa-check"></i><b>3.6</b> Graduated Symbology</a></li>
<li class="chapter" data-level="3.7" data-path="03-overlaypoints.html"><a href="03-overlaypoints.html#style-final-map"><i class="fa fa-check"></i><b>3.7</b> Style Final Map</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-newsvar.html"><a href="04-newsvar.html"><i class="fa fa-check"></i><b>4</b> Calculate Spatial Metrics</a><ul>
<li class="chapter" data-level="4.1" data-path="04-newsvar.html"><a href="04-newsvar.html#load-spatial-data-1"><i class="fa fa-check"></i><b>4.1</b> Load Spatial Data</a></li>
<li class="chapter" data-level="4.2" data-path="04-newsvar.html"><a href="04-newsvar.html#transform-projections"><i class="fa fa-check"></i><b>4.2</b> Transform Projections</a></li>
<li class="chapter" data-level="4.3" data-path="04-newsvar.html"><a href="04-newsvar.html#count-resources-by-area"><i class="fa fa-check"></i><b>4.3</b> Count resources by area</a><ul>
<li class="chapter" data-level="4.3.1" data-path="04-newsvar.html"><a href="04-newsvar.html#count-per-area"><i class="fa fa-check"></i><b>4.3.1</b> Count # per Area</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="04-newsvar.html"><a href="04-newsvar.html#buffer-data"><i class="fa fa-check"></i><b>4.4</b> Buffer Data</a></li>
<li class="chapter" data-level="4.5" data-path="04-newsvar.html"><a href="04-newsvar.html#count-buffers-by-area"><i class="fa fa-check"></i><b>4.5</b> Count buffers by area</a></li>
<li class="chapter" data-level="4.6" data-path="04-newsvar.html"><a href="04-newsvar.html#integrate-explore"><i class="fa fa-check"></i><b>4.6</b> Integrate &amp; Explore</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to R-Spatial for Healthy Places</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="adding-resources" class="section level1">
<h1><span class="header-section-number">3</span> Adding Resources</h1>
<p>In addition to areal data, we can also extract information from individual locations. Locations, when measured as points, can include things like:</p>
<ul>
<li><strong>Health providers:</strong> Hospitals, Clinics, Pharmacies, Mental health providers, Medication for opioid use disorder providers</li>
<li><strong>Area resources:</strong> Grocery stores &amp; Supermarkets, Playgrounds, Daycare centers, Schools, Community centers</li>
<li><strong>Area challenges:</strong> Crime, Superfund sites, Pollution-emitting facilities</li>
</ul>
<p>Points can also represent <em>people</em>, like individual patients residing in an area. Because individual locations for persons is protected health information, we’ll focus on point data as resources in the chapter. However, you can reuse the code snippets in this workshop to wrangle patient-level data the same way in a secure environment, under the guidance of your friendly IRB ethics board.</p>
<p>In this example, we’ll extend our Chicago example. We’ll identify areas with high COVID rates, low geographic access to methadone maintenance therapy, and less access to affordable rental housing units managed by the city. We are interested in locating zip codes that may be especially vulnerable to persons with opioid use disorder who use MOUDs. (This is oversimplified, but our example to work with.)</p>
<div id="geocode" class="section level2">
<h2><span class="header-section-number">3.1</span> Geocode</h2>
<p>If you start with only addresses, you’ll need to geocode. Our methadone maintenance provider dataset is only available as such. Addresses are comprised of characeters that reference a specific place. We will use the network topology service of a <em>Geocoder</em> to translate that address to a coordinate in some CRS.</p>
<p>First we load the <code>tidygeocoder</code> to get our geocoding done. Note, this uses the interent to process, so is not suitable for HIPPA protected data like individual, living person addresses. For offline geocoders, check out <code>Pelias</code> or <code>ESRI</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">library</span>(tidygeocoder)</a></code></pre></div>
<p>Let’s read in and inspect data for methadone maintenance providers. Note, these addresses were made available by SAMSHA, and are known as publicly available information. An additional analysis could call each service to check on access to medication during COVID in Septmber 2020, and the list would be updated further.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">methadoneClinics &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/chicago_methadone_nogeometry.csv&quot;</span>)</a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="kw">head</span>(methadoneClinics)</a></code></pre></div>
<pre><code>##   X                                                         Name
## 1 1                Chicago Treatment and Counseling Center, Inc.
## 2 2                      Sundace Methadone Treatment Center, LLC
## 3 3 Soft Landing Interventions/DBA Symetria Recovery of Lakeview
## 4 4                                        PDSSC - Chicago, Inc.
## 5 5                          Center for Addictive Problems, Inc.
## 6 6                                Family Guidance Centers, Inc.
##                   Address    City State   Zip
## 1 4453 North Broadway st. Chicago    IL 60640
## 2 4545 North Broadway St. Chicago    IL 60640
## 3    3934 N. Lincoln Ave. Chicago    IL 60613
## 4     2260 N. Elston Ave. Chicago    IL 60614
## 5        609 N. Wells St. Chicago    IL 60654
## 6     310 W. Chicago Ave. Chicago    IL 60654</code></pre>
<p>Let’s geocode one address first, just to make sure our system is working. We’ll use the “cascade” method which use the US Census and OpenStreetMap geocoders. These two services are the main options with <code>tidygeocoder</code>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">sample &lt;-<span class="st"> </span><span class="kw">geo</span>(<span class="st">&quot;2260 N. Elston Ave. Chicago, IL&quot;</span>, <span class="dt">lat =</span> latitude, <span class="dt">long =</span> longitude, <span class="dt">method =</span> <span class="st">&#39;cascade&#39;</span>)</a>
<a class="sourceLine" id="cb67-2" data-line-number="2"><span class="kw">head</span>(sample)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   address                         latitude longitude geo_method
##   &lt;chr&gt;                              &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     
## 1 2260 N. Elston Ave. Chicago, IL     41.9     -87.7 census</code></pre>
<p>As we prepare for geocoding, check out the structure of the dataset. Do we need to change anything? The data should be a character to be read properly.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">str</span>(methadoneClinics)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    27 obs. of  6 variables:
##  $ X      : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Name   : Factor w/ 25 levels &quot;*&quot;,&quot;A Rincon Family Services&quot;,..: 5 25 23 21 3 8 2 1 14 24 ...
##  $ Address: Factor w/ 27 levels &quot;110 E. 79th St.&quot;,..: 20 21 17 6 23 10 16 3 5 8 ...
##  $ City   : Factor w/ 1 level &quot;Chicago&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ State  : Factor w/ 1 level &quot;IL&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Zip    : int  60640 60640 60613 60614 60654 60654 60651 60607 60607 60616 ...</code></pre>
<p>We need to clean the data a bit. We’ll add a new column for a full address, as required by the geocoding service. When you use a geocoding service, be sure to read the documentation and understand how the data needs to be formatted for input.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">methadoneClinics<span class="op">$</span>fullAdd &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">as.character</span>(methadoneClinics<span class="op">$</span>Address), </a>
<a class="sourceLine" id="cb71-2" data-line-number="2">                                  <span class="kw">as.character</span>(methadoneClinics<span class="op">$</span>City),</a>
<a class="sourceLine" id="cb71-3" data-line-number="3">                                  <span class="kw">as.character</span>(methadoneClinics<span class="op">$</span>State), </a>
<a class="sourceLine" id="cb71-4" data-line-number="4">                                  <span class="kw">as.character</span>(methadoneClinics<span class="op">$</span>Zip))</a></code></pre></div>
<p>We’re ready to go! Batch geocode with one function, and inspect:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">geoCodedClinics &lt;-<span class="st">  </span><span class="kw">geocode</span>(methadoneClinics,</a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="dt">address =</span> <span class="st">&#39;fullAdd&#39;</span>, <span class="dt">lat =</span> latitude, <span class="dt">long =</span> longitude, <span class="dt">method =</span> <span class="st">&#39;cascade&#39;</span>)</a>
<a class="sourceLine" id="cb72-3" data-line-number="3"></a>
<a class="sourceLine" id="cb72-4" data-line-number="4"><span class="kw">head</span>(geoCodedClinics)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 10
##       X Name  Address City  State   Zip fullAdd latitude longitude
##   &lt;int&gt; &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;
## 1     1 Chic… 4453 N… Chic… IL    60640 4453 N…     NA        NA  
## 2     2 Sund… 4545 N… Chic… IL    60640 4545 N…     NA        NA  
## 3     3 Soft… 3934 N… Chic… IL    60613 3934 N…     42.0     -87.7
## 4     4 PDSS… 2260 N… Chic… IL    60614 2260 N…     41.9     -87.7
## 5     5 Cent… 609 N.… Chic… IL    60654 609 N.…     41.9     -87.6
## 6     6 Fami… 310 W.… Chic… IL    60654 310 W.…     41.9     -87.6
## # … with 1 more variable: geo_method &lt;chr&gt;</code></pre>
<p>There were two that didn’t geocode correctly. You can inspect further. This could involve a quick check for spelling issues; or, searching the address and pulling the lat/long using Google Maps and inputting manually. Or, if we are concerned it’s a human or unknown error, we could omit. For this exercise we’ll just omit the two clinics that didn’t geocode correctly.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">geoCodedClinics2 &lt;-<span class="st"> </span><span class="kw">na.omit</span>(geoCodedClinics)</a></code></pre></div>
</div>
<div id="convert-to-spatial-data" class="section level2">
<h2><span class="header-section-number">3.2</span> Convert to Spatial Data</h2>
<p>This is not spatial data yet! To convert a static file to spatial data, we use the powerful <code>st_as_sf</code> function from <code>sf</code>. Indicate the x,y parameters (=longitude, latitude) and the coordinate reference system used. Our geocoding service used the standard <strong>EPSG:4326</strong>, so we input that here.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb75-2" data-line-number="2"></a>
<a class="sourceLine" id="cb75-3" data-line-number="3">methadoneSf &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(geoCodedClinics2, </a>
<a class="sourceLine" id="cb75-4" data-line-number="4">                        <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>),</a>
<a class="sourceLine" id="cb75-5" data-line-number="5">                        <span class="dt">crs =</span> <span class="dv">4326</span>)</a></code></pre></div>
</div>
<div id="basic-map-of-points" class="section level2">
<h2><span class="header-section-number">3.3</span> Basic Map of Points</h2>
<p>For a really simple map of points – to ensure they were geocoded and converted to spatial data correctly, we use <code>tmap</code>. We’ll use the interactive version to view.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">library</span>(tmap)</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"></a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="kw">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</a>
<a class="sourceLine" id="cb76-4" data-line-number="4"></a>
<a class="sourceLine" id="cb76-5" data-line-number="5"><span class="kw">tm_shape</span>(methadoneSf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>() </a></code></pre></div>
<div id="htmlwidget-a41e31cb32a65ed1cb55" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-a41e31cb32a65ed1cb55">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,"Esri.WorldGrayCanvas",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircleMarkers","args":[[41.953304,41.922695,41.892677,41.896572,41.90435,41.88474325,41.87868,41.845146,41.88069,41.830036,41.840572,41.851788,41.802082,41.850292,41.86374,41.790287,41.778126,41.758877,41.77393,41.75102,41.74853,41.72576,41.74816,41.7497766,41.68698416768],[-87.67818,-87.67407,-87.634094,-87.63636,-87.721855,-87.6672503483257,-87.666824,-87.62532,-87.729004,-87.665565,-87.69513,-87.70332,-87.61789,-87.72703,-87.7349,-87.669334,-87.63265,-87.57673,-87.644646,-87.62112,-87.653694,-87.6012,-87.66339,-87.6877196829564,-87.6226997576],[2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619],["X3","X4","X5","X6","X7","X8","X9","X10","X11","X12","X13","X14","X15","X16","X17","X18","X19","X20","X21","X22","X23","X24","X25","X26","X27"],"methadoneSf",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000","#000000"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},null,null,["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>3<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Soft Landing Interventions/DBA Symetria Recovery of Lakeview<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>3934 N. Lincoln Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,613<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>3934 N. Lincoln Ave. Chicago IL 60613<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>4<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>PDSSC - Chicago, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>2260 N. Elston Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,614<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>2260 N. Elston Ave. Chicago IL 60614<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>5<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Center for Addictive Problems, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>609 N. Wells St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,654<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>609 N. Wells St. Chicago IL 60654<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>6<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Family Guidance Centers, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>310 W. Chicago Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,654<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>310 W. Chicago Ave. Chicago IL 60654<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>7<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>A Rincon Family Services<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>3809 W. Grand Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,651<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>3809 W. Grand Ave. Chicago IL 60651<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>8<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>*<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>140 N. Ashland Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,607<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>140 N. Ashland Ave. Chicago IL 60607<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>osm<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>9<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Healthcare Alternative Systems, Inc./NEXA <\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>210 N. Ashland Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,607<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>210 N. Ashland Ave. Chicago IL 60607<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>10<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>10<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Specialized Assistance Services, NFP<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>2630 S. Wabash Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,616<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>2630 S. Wabash Ave. Chicago IL 60616<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>11<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>11<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Garfield Counseling Center Full Service Program<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>4132 W. Madison St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,624<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>4132 W. Madison St. Chicago IL 60624<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>12<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>12<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Chicago Treatment and Counseling Center, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>3520 S. Ashland Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,609<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>3520 S. Ashland Ave. Chicago IL 60609<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>13<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>13<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Cermack Health Services of Cook County<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>2800 S. California Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,608<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>2800 S. California Ave. Chicago IL 60608<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>14<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>14<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Pilsen Wellness Center, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>3113 W. Cermak Rd.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,623<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>3113 W. Cermak Rd. Chicago IL 60623<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>15<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>15<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>HRDI- Grand Boulevard Professional Counseling Center<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>340 E. 51st St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,615<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>340 E. 51st St. Chicago IL 60615<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>16<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>16<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Katherine Boone Robinson Foundation<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>4100 W. Ogden Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,623<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>4100 W. Ogden Ave. Chicago IL 60623<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>17<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>17<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>New Age Services Corporation<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>1330 S. Kostner Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,623<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>1330 S. Kostner Ave. Chicago IL 60623<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>18<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>18<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Cornell Interventions Southwood-Adult<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>5701 S. Wood St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,636<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>5701 S. Wood St. Chicago IL 60636<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>19<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>19<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Family Guidance Centers, Inc. at St. Bernard Hospital<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>326 W. 64th st.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,621<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>326 W. 64th st. Chicago IL 60621<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>20<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>20<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Ijegba Community, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>1950 E 75th St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,649<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>1950 E 75th St. Chicago IL 60649<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>21<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>21<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Eva Mae Recovery Hope, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>6614 S Halsted St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,621<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>6614 S Halsted St. Chicago IL 60621<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>22<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>22<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>Nuway Community Services, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>110 E. 79th St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,619<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>110 E. 79th St. Chicago IL 60619<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>23<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>23<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>H.R.D.I- Professional Counseling Services<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>8000 S. Racine Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,620<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>8000 S. Racine Ave. Chicago IL 60620<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>24<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>24<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>*<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>936 E. 93rd St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,619<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>936 E. 93rd St. Chicago IL 60619<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>25<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>25<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>FOLA Community Action Services, Inc.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>8014 S. Ashland Ave.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,620<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>8014 S. Ashland Ave. Chicago IL 60620<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>census<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>26<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>26<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>New Hope Community Service Center<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>2559 W. 79th St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,652<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>2559 W. 79th St. Chicago IL 60652<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>osm<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>27<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\">X<\/td><td align=\"right\"><nobr>27<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Name<\/td><td align=\"right\"><nobr>H.R.D.I. West Pullman Professional Counseling Services<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Address<\/td><td align=\"right\"><nobr>33 E 114th St.<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">City<\/td><td align=\"right\"><nobr>Chicago<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">State<\/td><td align=\"right\"><nobr>IL<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">Zip<\/td><td align=\"right\"><nobr>60,628<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">fullAdd<\/td><td align=\"right\"><nobr>33 E 114th St. Chicago IL 60628<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\">geo_method<\/td><td align=\"right\"><nobr>osm<\/nobr><\/td><\/tr><\/table><\/div>"],null,["3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Esri.WorldGrayCanvas","OpenStreetMap","Esri.WorldTopoMap"],"methadoneSf",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[41.68698416768,41.953304],"lng":[-87.7349,-87.57673]},"fitBounds":[41.68698416768,-87.7349,41.953304,-87.57673,[]]},"evals":[],"jsHooks":[]}</script>
<p>If your points didn’t plot correctly:</p>
<ul>
<li>Did you flip the longitude/latitude values?</li>
<li>Did you input the correct CRS?</li>
</ul>
<p>Those two issues are the most common errors.</p>
</div>
<div id="overlay-points-style" class="section level2">
<h2><span class="header-section-number">3.4</span> Overlay Points &amp; Style</h2>
<p>Let’s add our zip code map from the previous module. First load the data, then overlay.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">Chi_Zipsf &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/ChiZipMaster1.geojson&quot;</span>)</a></code></pre></div>
<pre><code>## Reading layer `ChiZipMaster1&#39; from data source 
##   `/Users/maryniakolak/code/Intro2RSpatialMed/data/ChiZipMaster1.geojson&#39; 
##   using driver `GeoJSON&#39;
## Simple feature collection with 540 features and 31 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -87.87596 ymin: 41.64454 xmax: -87.52414 ymax: 42.02304
## CRS:           4326</code></pre>
<p>With this overlay, we’ll add a “hack” to include the methadone clinic points in a legend.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</a></code></pre></div>
<pre><code>## tmap mode set to plotting</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="co">## 1st layer (gets plotted first)</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="kw">tm_shape</span>(Chi_Zipsf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </a>
<a class="sourceLine" id="cb81-3" data-line-number="3">              <span class="dt">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="dt">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="dt">n=</span><span class="dv">4</span>, <span class="dt">title =</span> <span class="st">&quot;COVID Rt&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb81-5" data-line-number="5"><span class="st">  </span><span class="co">## 2nd layer (overlay)</span></a>
<a class="sourceLine" id="cb81-6" data-line-number="6"><span class="st">  </span><span class="kw">tm_shape</span>(methadoneSf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size =</span> <span class="fl">0.2</span>, <span class="dt">col =</span> <span class="st">&quot;gray20&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-7" data-line-number="7"><span class="st">  </span></a>
<a class="sourceLine" id="cb81-8" data-line-number="8"><span class="st">  </span><span class="co">## &quot;Hack&quot; a manual symbology for dots in the legend</span></a>
<a class="sourceLine" id="cb81-9" data-line-number="9"><span class="st">  </span><span class="kw">tm_add_legend</span>(<span class="st">&quot;symbol&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;gray20&quot;</span>, <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">labels =</span> <span class="st">&quot;Methadone MOUD&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-10" data-line-number="10"><span class="st">  </span></a>
<a class="sourceLine" id="cb81-11" data-line-number="11"><span class="st">  </span><span class="co">## Cartographic Styling</span></a>
<a class="sourceLine" id="cb81-12" data-line-number="12"><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>, <span class="dt">legend.outside.position =</span> <span class="st">&quot;right&quot;</span>)</a></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
<div id="integrate-more-data-1" class="section level2">
<h2><span class="header-section-number">3.5</span> Integrate More Data</h2>
<p>From here, we can integrate more data. Let’s try a different point dataset – Affordable Rental Housing Developments, as made available by the <em>City of Chicago Data Portal</em>. This could be interesting for a number of different reasons – maybe we hypothesize better outcomes are associated with better access to affordable housing options? Or, we hypothesize the opposite, that mean distance to more population dense housing locations is vulnerable to airborne disease?</p>
<p>For this example, we’ll think about this dataset as access to secure and affordable housing. Persons with lower incomes residing in places with fewer developments may be more vulnerable to housing insecurity -&gt; impacts health.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">AffHousing &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Affordable_Rental_Housing_Developments.csv&quot;</span>)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2"></a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="kw">head</span>(AffHousing)</a></code></pre></div>
<pre><code>##   Community.Area.Name Community.Area.Number      Property.Type
## 1           Englewood                    68           Veterans
## 2         Rogers Park                     1             Senior
## 3              Uptown                     3                ARO
## 4           Edgewater                    77             Senior
## 5            Roseland                    49 Supportive Housing
## 6       Humboldt Park                    23        Multifamily
##          Property.Name                            Address Zip.Code
## 1   Hope Manor Village 5900-6100 S. Green/Peoria/Sangamon    60621
## 2   Morse Senior Apts.                 6928 N. Wayne Ave.    60626
## 3           The Draper                   5050 N. Broadway    60640
## 4        Pomeroy Apts.               5650 N. Kenmore Ave.    60660
## 5    Wentworth Commons            11045 S. Wentworth Ave.    60628
## 6 Nelson Mandela Apts.                 607 N. Sawyer Ave.    60624
##   Phone.Number             Management.Company Units X.Coordinate
## 1 312-564-2393 Volunteers of America Illinois    36           NA
## 2 312-602-6207               Morse Urban Dev.    44      1165844
## 3 312-818-1722                      Flats LLC    35      1167357
## 4 773-275-7820                Habitat Company   198      1168181
## 5 773-568-7804        Mercy Housing Lakefront    50      1176951
## 6 773-227-6332               Bickerdike Apts.     6      1154640
##   Y.Coordinate Latitude Longitude
## 1           NA       NA        NA
## 2      1946059 42.00757 -87.66517
## 3      1933882 41.97413 -87.65996
## 4      1937918 41.98519 -87.65681
## 5      1831516 41.69302 -87.62777
## 6      1903912 41.89215 -87.70753
##                                Location
## 1                                      
## 2 (42.0075737709331, -87.6651711448293)
## 3 (41.9741295261027, -87.6599553011627)
## 4  (41.9851867755403, -87.656808676983)
## 5 (41.6930159120977, -87.6277673462214)
## 6 (41.8921534052465, -87.7075265659001)</code></pre>
<p>There were a few data points with odd inputs and null values. Remember, we can’t convert any null values to spatial coordinates. Again, in an ideal context, you would explore and understand what is happening, systematically. In our experiment, we’ll omit nulls.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">AffHousing &lt;-<span class="st"> </span><span class="kw">na.omit</span>(AffHousing)</a></code></pre></div>
<p>Look at the structure of the object.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">str</span>(AffHousing)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    487 obs. of  14 variables:
##  $ Community.Area.Name  : Factor w/ 65 levels &quot;Albany Park&quot;,..: 49 55 17 50 25 22 65 45 45 37 ...
##  $ Community.Area.Number: int  1 3 77 49 23 38 42 36 36 8 ...
##  $ Property.Type        : Factor w/ 26 levels &quot;65+/Supportive&quot;,..: 13 2 13 19 8 8 8 8 13 19 ...
##  $ Property.Name        : Factor w/ 394 levels &quot;1038 N. Ashland&quot;,..: 214 338 257 376 218 186 109 235 234 348 ...
##  $ Address              : Factor w/ 478 levels &quot;10 N. Hamlin Ave.&quot;,..: 424 348 367 17 384 298 71 279 275 64 ...
##  $ Zip.Code             : int  60626 60640 60660 60628 60624 60653 60637 60653 60653 60622 ...
##  $ Phone.Number         : Factor w/ 326 levels &quot;217-779-5697&quot;,..: 57 78 134 221 111 232 225 164 164 32 ...
##  $ Management.Company   : Factor w/ 200 levels &quot;@properties&quot;,..: 112 57 66 104 17 80 176 167 169 74 ...
##  $ Units                : int  44 35 198 50 6 71 67 534 148 40 ...
##  $ X.Coordinate         : num  1165844 1167357 1168181 1176951 1154640 ...
##  $ Y.Coordinate         : num  1946059 1933882 1937918 1831516 1903912 ...
##  $ Latitude             : num  42 42 42 41.7 41.9 ...
##  $ Longitude            : num  -87.7 -87.7 -87.7 -87.6 -87.7 ...
##  $ Location             : Factor w/ 477 levels &quot;&quot;,&quot;(41.648457411436, -87.5401231660406)&quot;,..: 475 455 462 8 289 122 67 147 151 328 ...
##  - attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int 1
##   ..- attr(*, &quot;names&quot;)= chr &quot;1&quot;</code></pre>
<p>In this dataset, we can see coordinate information is already included – twice! You’re looking at 2 different types of coordinate systems. We’ll use “Longitude” and “Latitude” to represent X,Y and an ESPG of 4326. We’re guessing, and hopeful.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">AffHousingSf &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(AffHousing, </a>
<a class="sourceLine" id="cb87-2" data-line-number="2">                        <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>),</a>
<a class="sourceLine" id="cb87-3" data-line-number="3">                        <span class="dt">crs =</span> <span class="dv">4326</span>)</a></code></pre></div>
<p>We can now map the data for a quick view – does this look like Chicago, hopefully?</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">tm_shape</span>(AffHousingSf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>() </a></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="graduated-symbology" class="section level2">
<h2><span class="header-section-number">3.6</span> Graduated Symbology</h2>
<p>Previously we mapped points as dots. We literally used the <code>tm_dots()</code> function to do so. Another option is changing the size of the point, according to some attribute of the data. In this dataset, we see an attribute field that gives us the total number of units per housing site. Let’s use a graduated symbology, with the <code>tm_bubbles()</code> function, to map these points. That way points with more units will be bigger, and not all places are weighted the same visually.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">tm_shape</span>(Chi_Zipsf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gray80&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="st">  </span><span class="kw">tm_shape</span>(AffHousingSf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_bubbles</span>(<span class="st">&quot;Units&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>) </a></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="style-final-map" class="section level2">
<h2><span class="header-section-number">3.7</span> Style Final Map</h2>
<p>Let’s pull what we learned in the last tutorial, and map everything at once. Which zip codes are the most vulnerable to persons with OUD during the pandemic in September 2020, based on the information we have here?</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="co">## Zip Codes with Labels</span></a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="kw">tm_shape</span>(Chi_Zipsf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_fill</span>(<span class="st">&quot;Case.Rate...Cumulative&quot;</span>, </a>
<a class="sourceLine" id="cb90-3" data-line-number="3">      <span class="dt">style=</span><span class="st">&quot;jenks&quot;</span>, <span class="dt">pal=</span><span class="st">&quot;BuPu&quot;</span>, <span class="dt">n=</span><span class="dv">4</span>, <span class="dt">title =</span> <span class="st">&quot;COVID Rt&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="st">      </span><span class="kw">tm_text</span>(<span class="st">&quot;zip&quot;</span>, <span class="dt">size =</span> <span class="fl">0.7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-5" data-line-number="5"></a>
<a class="sourceLine" id="cb90-6" data-line-number="6"><span class="st">  </span><span class="co">## Affordable Housing Units</span></a>
<a class="sourceLine" id="cb90-7" data-line-number="7"><span class="st">  </span><span class="kw">tm_shape</span>(AffHousingSf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_bubbles</span>(<span class="st">&quot;Units&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb90-9" data-line-number="9"><span class="st">  </span><span class="co">## Methadone MOUD</span></a>
<a class="sourceLine" id="cb90-10" data-line-number="10"><span class="st">  </span><span class="kw">tm_shape</span>(methadoneSf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>(<span class="dt">size =</span> <span class="fl">0.2</span>, <span class="dt">col =</span> <span class="st">&quot;gray20&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb90-12" data-line-number="12"><span class="st">  </span><span class="co">## Cartographic Styling</span></a>
<a class="sourceLine" id="cb90-13" data-line-number="13"><span class="st">  </span><span class="kw">tm_add_legend</span>(<span class="st">&quot;symbol&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;gray20&quot;</span>, <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">labels =</span> <span class="st">&quot;Methadone MOUD&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>, <span class="dt">legend.outside.position =</span> <span class="st">&quot;right&quot;</span>)</a></code></pre></div>
<p><img src="Spatial-R-for-Healthy-Places_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>In RStudio, you could zoom into the plot you created to get a better view. Save as an image, or save as a webpage!</p>
<p>Save any data you need from this session.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="co">#st_write(obj = methadoneSf, dsn = &quot;data/methadoneMOUD.geojson&quot;)</span></a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="02-choropleth.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="04-newsvar.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
